{% load i18n %}
{% load static i18n %}
<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}{{ cfg.site_title }}{% endblock %}</title>
  {% if cfg.favicon %}
   <link rel="shortcut icon" href="{{ cfg.favicon.url }}" type="image/x-icon">
 {% else %}
   <link rel="shortcut icon" href="{% static 'img/default-favicon.ico' %}" type="image/x-icon">
 {% endif %}
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" 
  rel="stylesheet" integrity="sha384-..." crossorigin="anonymous">
  <link href="{% static 'css/site.css' %}" rel="stylesheet">
  {% block extra_head %}{% endblock %}
</head>
<body class="d-flex flex-column min-vh-100"
     style="background: {{ cfg.body_bg_color }}; color: {{ cfg.body_text_color }};">
    <header>
  <nav class="navbar navbar-expand-md" style="background: {{ cfg.header_color }};">
    <div class="container">
      <!-- Brand: logo + title -->
      <a class="navbar-brand d-flex align-items-center" href="{% url 'portal_thematic:index' %}">
        {% if cfg.logo %}
          <img src="{{ cfg.logo.url }}" alt="{{ cfg.site_title }}" style="height:40px;">
        {% endif %}
        <span class="ms-2 fw-bold" 
              style="color: {{ cfg.header_text_color }}; font-size:1.25rem;">
          {{ cfg.site_title }}
        </span>
      </a>

      <!-- Toggler button for mobile -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
              data-bs-target="#mainNavbar" aria-controls="mainNavbar"
              aria-expanded="false" aria-label="{% trans 'Toggle navigation' %}">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Collapsible content -->
      <div class="collapse navbar-collapse" id="mainNavbar">
        <ul class="navbar-nav ms-auto align-items-center">
          <!--Main -->
          <li class="nav-item">
            <a class="nav-link" href="{% url 'portal:index' %}"
               style="color: {{ cfg.login_text_color }};">
              {% trans "Main" %}
            </a>
          </li>
          <!--Home -->
          <li class="nav-item">
            <a class="nav-link" href="{% url 'portal_thematic:index' %}"
               style="color: {{ cfg.login_text_color }};">
              {% trans "Home" %}
            </a>
          </li>
          <!-- About -->
          <li class="nav-item">
            <a class="nav-link" href="{% url 'portal_thematic:about' %}"
               style="color: {{ cfg.login_text_color }};">
              {% trans "About" %}
            </a>
          </li>
          

          <!-- Language selector -->
          <li class="nav-item">
            <form action="{% url 'set_language' %}" method="post" class="d-flex mx-md-2">
              {% csrf_token %}
              <select name="language" onchange="this.form.submit()"
                      class="form-select form-select-sm"
                      style="color: {{ cfg.header_text_color }};">
                {% get_current_language as LANGUAGE_CODE %}
                <option value="en" {% if LANGUAGE_CODE == 'en' %}selected{% endif %}>English</option>
                <option value="ar" {% if LANGUAGE_CODE == 'ar' %}selected{% endif %}>Arabic</option>
              </select>
            </form>
          </li>

          <!-- Login / User / Logout -->
          {% if user.is_authenticated %}
            <li class="nav-item">
              <span class="nav-link" style="color: {{ cfg.header_text_color }};">
                {{ user.get_full_name|default:user.username }}
              </span>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'portal_thematic:logout' %}"
                 style="color: {{ cfg.login_text_color }};">
                {% trans "Logout" %}
              </a>
            </li>
          {% else %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'admin:login' %}"
                 style="color: {{ cfg.login_text_color }};">
                {% trans "Login" %}
              </a>
            </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </nav>
</header>


  <main class="flex-fill container">
    {% block content %}{% endblock %}
  </main>

  <footer class="mt-auto p-3 text-center" style="background: {{ cfg.footer_color }}; color: {{ cfg.footer_text_color }};">
    &copy; {{ cfg.organization }} {{ cfg.copyright_year }}
  </footer>
  <script 
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" 
  integrity="sha384-..." crossorigin="anonymous">
</script>
</body>
</html>
